/*! Theresa's Sound World - v0.1.13 - (c) 2014 Stuart Memo */(function(e){"use strict";var t,n="0.1.13";t=function(){var t=function(e,t){for(var n in t)e[n]=t[n];return e},r=function(e,t){for(var n in t)e[n].value=t[n]},o=function(e){return Array.isArray(e)},i=function(e){return"function"==typeof e},a=function(e){return"object"==typeof e},u=function(e){return"string"==typeof e},s=function(e){return"number"==typeof e},c=function(e){return e!==undefined},f=function(e){return c(e),c(e)&&null!==e?!0:undefined},p=function(e){var t=!1;return Object(e)&&"node"in e&&(t=!0),t},l=function(e){return e.context!==undefined},d=function(e){return e.hasOwnProperty("input")||e.hasOwnProperty("output")},h=function(e){return a(e)?"setValueAtTime"in e:!1},m=function(e,t,n,r,o){if(f(o))switch(o){case"linear":e[t].setValueAtTime(e[t].value,y.now()),e[t].linearRampToValueAtTime(n,r);break;case"exponential":e[t].setValueAtTime(e[t].value,y.now()),0===n&&(n=1e-8),e[t].exponentialRampToValueAtTime(n,r);break;default:e[t].setValueAtTime(n,r)}else e[t].setValueAtTime(n,r)},g=function(e,t){return e&&f(e[t])?f(e[t].value)?e[t].value:e[t]:undefined},v=function(e,t,n,r,o){f(e[t].value)?f(r)?m(e,t,n,r,o):e[t].value=n:e[t]=n},w=function(e,t){return function(n,r,o){return f(n)?v(e,t,n,r,o):g(e,t)}},y={},b=[];y.version=n,y.isBrowserSupported=!1,y.processors=[];var T=function(e,t){var n;if("undefined"==typeof webkitAudioContext&&"undefined"==typeof AudioContext)if(webkitAudiocontext().prototype.createGainNode===undefined)t("Sorry, your browser doesn't support a recent enough version of the Web Audio API.");else{var r=webkitAudiocontext().prototype;r.createGain=r.createGainNode,r.createDelay=r.createDelayNode,r.createScriptProcessor=r.createJavaScriptNode}else"function"==typeof AudioContext?(n=new AudioContext,y.context=function(){return n}):(n=new webkitAudioContext,y.context=function(){return n});y.isBrowserSupported=!0,e()},x=function(){y.speakers=y.context().destination,y.osc=y.oscillator};y.now=function(){return this.context().currentTime},y.channelSplitter=function(){return y.context().createChannelSplitter()},y.channelMerger=function(e){return y.context().createChannelMerger(e)},y.connect=function(){var e,t=arguments.length,n=function(){arguments[0].connect(arguments[1],0,arguments[2])},r=function(){arguments[0].connect(arguments[1].input,0,arguments[2])},i=function(){for(var e=0;arguments[1].length>e;e++)y.connect(arguments[0],arguments[1][e])},a=function(){for(var e=0;arguments[0].length>e;e++)y.connect(arguments[0][e],arguments[1])},u=function(){arguments[0].output.connect(arguments[1].input,0,arguments[2])},s=function(){arguments[0].output.connect(arguments[1],0,arguments[2])},c=function(){for(var e=0;arguments[0].length>e;e++)y.connect(arguments[0][e],arguments[1])},f=function(){for(var e=0;arguments[0].length>e;e++)y.connect(arguments[0][e],arguments[1])},m=function(){arguments[0].connect(arguments[1])},g=function(){arguments[0].output.connect(arguments[1])};for(e=0;t-1>e;e++){var v=arguments[e],w=arguments[e+1];if(l(v)&&d(w))r(v,w);else if(d(v)&&l(w))s(v,w);else if(l(v)&&o(w))i(v,w);else if(o(v)&&l(w))a(v,w);else if(l(v)&&l(w))n(v,w);else if(d(v)&&d(w))u(v,w);else if(d(v)&&o(w))connectTswNodeToArray(v,w);else if(o(v)&&d(w))c(v,w);else if(o(v)&&o(w))f(v,w);else if(p(v)&&o(w))connectObjectWithNodeToArray(v,w);else if(o(v)&&p(w))connectArrayToObjectWithNode(v,w);else{if(p(v)&&p(w)){if(l(v.node)&&l(w.node)){n(v.node,w.node,w.channel);continue}if(d(v.node)&&l(w.node)){s(v.node,w.node,w.channel);continue}if(l(v.node)&&d(w.node)){r(v.node,w.node,w.channel);continue}if(d(v.node)&&d(w.node)){u(v.node,w.node,w.channel);continue}}l(v)&&h(w)?m(v,w):d(v)&&h(w)&&g(v,w)}}},y.disconnect=function(){for(var e=arguments.length,t=0;e>t;t++)arguments[t].hasOwnProperty("disconnect")&&arguments[t].disconnect(),arguments[t].hasOwnProperty("input")&&y.disconnect(arguments[t].input),arguments[t].hasOwnProperty("ouput")&&y.disconnect(arguments[t].output)},y.disconnectAfterTime=function(e,t){b.push({node:e,time:t})},y.load=function(){var e,t,n={},r=arguments[0],o="",a=[],u=0,s=0,c=0,f=this,p=function(e,t,n,r,o,a){var p=new XMLHttpRequest;p.open("GET",e+n,!0),p.responseType="arraybuffer";var l=function(){u++,f.context().decodeAudioData(p.response,function(e){r[t]=e,Object.keys(r).length===c&&o(r)})},d=function(){s++,i(a)?a():console.log("There was an error loading your file(s)",p.status)};p.onreadystatechange=function(){4===p.readyState&&(200===p.status?l():d())},p.send()};if("object"==typeof arguments[1]?(o=arguments[1].path||"",a=arguments[1].extensions||[]):"function"==typeof arguments[1]&&(e=arguments[1]),"function"==typeof arguments[2]&&(t=arguments[2]),"object"==typeof r){c=Object.keys(r).length;for(var l in r)p(o,l,r[l],n,e,t)}else{if("string"!=typeof r)throw Error("Files must be an array or a valid string.");c=1,p(o,l,r[l],n,e)}},y.wait=function(e){var t,n=this.context().createDelay();return t=y.createNode(),t.nodeType="wait",t.time=w(n,"delayTime"),t.time(e||1),y.connect(t.input,n,t.output),t},y.createMonoMaker=function(){var e={};return e.input=y.createGain(),e.output=y.createGain(),y.connect(e.input,e.output),e},y.panner=function(e){var t,n=(y.gain(),y.gain(0)),r=y.gain(0),o=y.channelMerger(2);t=y.createNode(),t.nodeType="panner";var i=function(e){return e>1?e=1:-1>e&&(e=-1),e};return t.pan=function(e,t){var o;return c(e)?(e=i(e||0),o=1-(e+1)/2,n.gain(o,t),r.gain(1-o,t),undefined):-(2*(n.gain()-1))-1},t.pan(e||0),y.connect(t.input,[n,r]),y.connect({node:n},{node:o,channel:0}),y.connect({node:r},{node:o,channel:1}),y.connect(o,t.output),t},y.play=function(e,t){t=t||0,o(e)?e.forEach(function(e){e.start(t)}):e.start(t)},y.stop=function(e,t){t=t||0,e.stop(t)},y.reverse=function(e){for(var t=0;e.buffer.numberOfChannels>t;t++)Array.prototype.reverse.call(e.buffer.getChannelData(t));return e};var A=function(e){this.start=function(t){return e.sourceNode.start===undefined?e.sourceNode.noteOn(t||y.now()):e.sourceNode.start(t||y.now()),this},this.stop=function(t){return e.sourceNode.stop===undefined?e.sourceNode.noteOff(t||y.now()):e.sourceNode.stop(t||y.now()),this}};y.createNode=function(e){var t={};return e=e||{},t.input=y.context().createGain(),t.output=y.context().createGain(),Object.keys(e).forEach(function(n){t[n]=e[n]}),t.connectedTo=[],e.hasOwnProperty("sourceNode")?A.call(t,e):e.sourceNode=!1,t},y.oscillator=function(e,t){var n,r=y.context().createOscillator();return n=y.createNode({sourceNode:r,nodeType:"oscillator"}),n.frequency=w(r,"frequency"),n.type=w(r,"type"),n.detune=w(r,"detune"),n.params={frequency:r.frequency},n.frequency(e||440),n.type((t||"sine").toLowerCase()),n.isPlaying=function(){return 2===r.playbackState?!0:!1},this.connect(r,n.output),n},y.gain=function(e,t){var n,r;return r="function"==typeof this.context().createGain?this.context().createGain():this.context().createGainNode(),n=y.createNode({nodeType:"gain"}),n.params={gain:r.gain},n.gain=w(r,"gain"),n.gain(e,t),this.connect(n.input,r,n.output),n},y.buffer=function(e,t,n){var r;return e=e||1,t=t||65536,n=n||44100,r=this.context().createBuffer(e,t,n),r.nodeType="buffer",r},y.bufferBox=function(e){var t,n,r=y.createNode({nodeType:"bufferBox",timePaused:0,paused:!1}),o=!1,i=0,a=0;return r.buffer=function(e){return e?(t=e,undefined):t},r.loop=function(e){return o=e,this},e&&r.buffer(e),r.play=function(){var e=this;n=y.context().createBufferSource(),n.buffer=t,n.loop=o,this.paused=!1,y.connect(n,r.output),n.onended=function(){e.paused||e.position(0)},i=y.now(),n.start(y.now(),this.position())},r.position=function(e){return e||0===e?(a=e,undefined):a||0},r.start=r.play,r.stop=function(e){this.paused=!1,n.stop(e||y.now()),this.position(0)},r.pause=function(e){this.paused=!0,n.stop(e||y.now()),y.disconnect(n),this.position(y.now()-i+this.position())},r},y.decode=function(e,t,n){this.context().decodeAudioData(e,t,n)},y.filter=function(){var e=y.createNode({type:"filter"}),t={},n=y.context().createBiquadFilter();return a(arguments[0])?(t.type=arguments[0].type,t.frequency=arguments[0].frequency||1e3,t.Q=arguments[0].Q):u(arguments[0])&&(t.type=arguments[0]),e.nodeType="filter",e.type=w(n,"type"),e.frequency=w(n,"frequency"),e.Q=w(n,"Q"),e.type(t.type||"lowpass"),e.frequency(t.frequency||1e3),e.Q(t.Q||0),this.connect(e.input,n,e.output),e},y.analyser=function(){return this.context().createAnalyser()},y.compressor=function(e){var n=y.createNode({nodeType:"compressor"}),o=this.context().createDynamicsCompressor(),i={threshold:-24,knee:30,ratio:12,attack:.003,release:.25};return e=t(i,e),r(o,e),this.connect(n.input,o,n.output),n},y.processor=function(e,t){var n=e||1024,r=y.context().createScriptProcessor(n,1,1);return"function"==typeof t&&(r.onaudioprocess=function(e){t(e)}),r},y.waveShaper=function(){for(var e=this.context().createWaveShaper(),t=new Float32Array(65536),n=0;32768>n;n++)t[n]=3e4>n?.1:-1;return e.curve=t,e},y.envelope=function(e){var t={};return e=e||{},t.name=e.name||"",t.nodeType="envelope",t.startLevel=e.startLevel||0,t.maxLevel=e.maxLevel||1,t.minLevel=e.minLevel||0,t.param=e.param||null,t.attackTime=e.attack||0,t.decayTime=e.decay||1,t.sustainLevel=e.sustain||1,t.releaseTime=e.release||1,h(e.param)&&(t.param=e.param),t.start=function(e){var t=this.attackTime+this.decayTime;t+this.releaseTime,this.maxLevel=this.startLevel+this.maxLevel,this.sustainLevel=this.startLevel+this.sustainLevel,h(this.param)&&(e=e||y.now(),this.param.setValueAtTime(this.startLevel,e),this.param.linearRampToValueAtTime(this.maxLevel,e+this.attackTime),this.param.setTargetAtTime(this.sustainLevel,e+this.attackTime,.05))},t.release=function(e){e=e||y.now(),e+=this.releaseTime,h(this.param)&&this.param.setTargetAtTime(this.minLevel,e,this.releaseTime/10)},t},y.noise=function(){var e,t=this.buffer(),n=this.bufferBox(),r=t.length;for(e=0;r>e;e++)t.getChannelData(0)[e]=2*Math.random()-1;return n.nodeType="noise",n.buffer(t),n.loop(!0),n},y.lfo=function(e){var t,n=y.oscillator(e||10);return t=y.createNode({sourceNode:n,nodeType:"lfo"}),t.modulate=function(e){f(e)&&(y.connect(n,e),n.start())},t.frequency=n.frequency,t},y.getUserAudio=function(e,t){var n=function(t){var n=y.context().createMediaStreamSource(t);e(n)};navigator.webkitGetUserMedia({audio:!0},n,t)};var N=function(){(function e(){b.forEach(function(e){e.time<y.now()&&y.disconnect(e.node)}),setTimeout(e,500)})()};return y.helper={},y.helper.isString=u,y.helper.isNumber=s,y.init=function(){T(function(){x(),N()},function(e){console.log(e)})},e.tsw=y}(),t.init()})(window),function(e){"use strict";e.tsw=tsw||{},tsw.delay=function(e){var t=tsw.createNode(),n=tsw.wait(),r=tsw.gain(),o=tsw.gain(),i=tsw.gain();return t.settings={delayTime:.5,feedback:.5,level:.5},e=e||{},n.delayTime.value=e.delayTime||t.settings.delayTime,r.gain.value=e.feedback||t.settings.feedback,o.gain.value=e.level||t.settings.level,tsw.connect(t.input,i,n,r,n,o,t.output),tsw.connect(i,n),t},tsw.distortion=function(e){var t=tsw.createNode(),n=tsw.context().createWaveShaper(),r=tsw.context().createBiquadFilter(),o=tsw.context().createBiquadFilter();return t.settings={distortionLevel:.5},e=e||{},tsw.connect(t.input,n,[r,o],t.output),t},tsw.phaser=function(e){var t=tsw.createNode(),n=[],r=tsw.gain(),o=0;for(t.settings={rate:8,depth:.5,feedback:.8},e=e||{},r.gain.value=e.feedback||t.settings.feedback,e.rate=e.rate||t.settings.rate,o=0;e.rate>o;o++)n[o]=tsw.context().createBiquadFilter(),n[o].type=7,n[o].frequency.value=100*o;for(o=0;n.length-1>o;o++)tsw.connect(n[o],n[o+1]);return tsw.connect(t.input,n[n.length-1],r,n[0]),tsw.connect(n[n.length-1],t.output),t.setCutoff=function(e){for(var t=0;n.length>t;t++)n[t].frequency.value=e},t},tsw.reverb=function(e){var t=tsw.context().createConvolver(),n=tsw.gain(),r={},o={effectLevel:.5,reverbTime:.5,reverbType:"spring",reverbPath:""};return e=e||{},n.gain.value=e.effectLevel||o.effectLevel,tsw.load({hall:"/effects/reverb/responses/bright-hall.wav",room:"/effects/reverb/responses/medium-room.wav",spring:"/effects/reverb/responses/feedback-spring.wav"},function(e){o.reverbPath=e[o.reverbType],t.buffer=o.reverbPath,r.input=tsw.gain(),r.output=tsw.gain(),tsw.connect(r.input,[r.output,t]),tsw.connect(t,n),tsw.connect(n,r.output)}),r},tsw.tremolo=function(e){var t={},n=(tsw.gain(),this.lfo()),r=this;return e=e||{},t.input=tsw.gain(),t.connect=function(e){t.input.connect(e),n.modulate(t.input.gain),n.start(r.now())},t.setRate=function(e){n.frequency(e)},t.setDepth=function(e){n.depth(e)},t}}(window),function(){"use strict";var e=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];e.push.apply(e,e);var t=["unison","flat 2nd","2nd","minor 3rd","major 3rd","perfect 4th","flat 5th","perfect 5th","minor 6th","major 6th","minor 7th","major 7th","octave","flat 9th","9th","sharp 9th","major 10th","11th","augmented 11th","perfect 12th","flat 13th","13th"];tsw.helper.getNotePosition=function(t){for(var n,r=e.length,o=0;r>o;o++)if(t.toUpperCase()===e[o])return n=o,o;return null};var n=function(t){var n=[],r=tsw.helper.getNotePosition(t);return n.push(e[r]),n.push(e[r+2]),n.push(e[r+4]),n.push(e[r+5]),n.push(e[r+7]),n.push(e[r+9]),n.push(e[r+11]),n.push(e[r+12]),n},r=function(t){var n=[],r=tsw.helper.getNotePosition(t);return n.push(e[r]),n.push(e[r+2]),n.push(e[r+3]),n.push(e[r+5]),n.push(e[r+7]),n.push(e[r+8]),n.push(e[r+10]),n.push(e[r+12]),n},o=function(e){return"string"!=typeof e||e.length>3?!1:!0};tsw.chord=function(t){var n={},r=[],o=0;return Array.isArray(t)?!1:(t=t.toLowerCase(),n.rootNote=t[0].toUpperCase(),n.isMajor=t.indexOf("maj")>-1,n.isMinor=!n.isMajor&&t.indexOf("m")>-1,n.is7th=t.indexOf("7")>-1,n.notes=[],n.is7th||(n.octave=t.match(/\d/g)),n.isMajor||n.isMinor||t.is7th||(n.isMajor=!0),o=tsw.helper.getNotePosition(n.rootNote),r.push(o),t.isMinor?r.push(o+tsw.semitoneDifference("minor 3rd")):r.push(o+tsw.semitoneDifference("major 3rd")),r.push(o+tsw.semitoneDifference("perfect 5th")),r.push(o+tsw.semitoneDifference("octave")),r.forEach(function(t){n.notes.push(e[t])}),n.notes)},tsw.scale=function(e,t){return"minor"===t?r(e):n(e)},tsw.semitoneDifference=function(e){for(var n=t.length,r=0;n>r;r++)if(e===t[r])return r},tsw.flat=function(e){var t;return e=e.replace("#","b"),t=String.fromCharCode(e[0].toUpperCase().charCodeAt(0)+1),"H"===t&&(t="A"),t+=e.substr(1)},tsw.sharp=function(e){var t,n=0;return-1===e.indexOf("b")?e:(e=e.replace("b","#"),t=String.fromCharCode(e[0].toUpperCase().charCodeAt(0)-1),"@"===t&&(t="G"),"B"===t&&(n=e.search(/\d/),n>-1&&(e=e.substring(0,n)+(e[n]-1)+e.substring(n+1))),t+=e.substr(1))},tsw.frequency=function(t){var n,r,i,a;return o(t)===!1?!1:(i=t.search(/\d/),n=parseInt(t.slice(-1)),isNaN(n)&&(n=4),t=this.sharp(t),a=t,i>-1&&(a=t.substr(0,i)),r=e.indexOf(a.toUpperCase()),r+=12*n,parseFloat(440*Math.pow(2,(r-57)/12),10))}}(window),function(){"use strict";tsw=tsw||{},tsw.isMidiSupported=function(){return"function"==typeof navigator.requestMIDIAccess},tsw.getUserMidi=function(e,t){this.isMidiSupported()&&navigator.requestMIDIAccess().then(e,t)};var e=function(e){var t=e.match(/^[A-g#]+/)[0],n=parseInt(e.match(/\d+/g),10),r=tsw.helper.getNotePosition(t);return r+12*n},t=function(e){var t=e%12,n=Math.floor(e/12),r=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];return r.push.apply(r,r),r[t]+n};tsw.midiNote=function(n){return tsw.helper.isString(n)?e(n):tsw.helper.isNumber(n)?t(n):undefined}}(window),function(){"use strict";var e=function(e){var t=Math.floor(e/60);return{minutes:t,seconds:e-60*t,totalSeconds:e}};tsw.analyser=function(){var e=tsw.context().createAnalyser();return e},tsw.info=function(t){return{duration:e(t.duration),numberOfChannels:t.numberOfChannels,sampleRate:t.sampleRate}}}(window);